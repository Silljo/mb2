{"version":3,"sources":["../../src/pages/user-postavke/user-postavke.module.ts","../../src/pages/user-postavke/user-postavke.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { UserPostavkePage } from './user-postavke';\n\n@NgModule({\n  declarations: [\n    UserPostavkePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(UserPostavkePage),\n  ],\n})\nexport class UserPostavkePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/user-postavke/user-postavke.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController } from 'ionic-angular';\nimport { Camera, CameraOptions } from '@ionic-native/camera';\nimport { AngularFireDatabase } from 'angularfire2/database';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { Firebase } from '@ionic-native/firebase';\nimport * as firebase from 'firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-user-postavke',\n  templateUrl: 'user-postavke.html',\n})\nexport class UserPostavkePage {\n\n  slika: string;\n  slika_validation: string;\n\n  korisnik_naziv: string;\n  korisnik_slika: string;\n\n  smjestaj_toggle: boolean;\n  gastro_toggle: boolean;\n  dogadjanja_toggle: boolean;\n  duhovni_kutak_toggle: boolean;\n  uid: string;\n\n  constructor(public navCtrl: NavController, public camera: Camera, public db: AngularFireDatabase,\n              public auth: AngularFireAuth, public firebase_plugin: Firebase) {\n\n  }\n\n  ionViewDidLoad() {\n\n    this.auth.authState.subscribe(data => {\n      if (data && data.uid) {\n\n        this.uid = data.uid;\n\n        //E sad da prvo vidimo da li je to komunalni redar\n        this.db.object(\"/user_profiles/\" + data.uid).valueChanges().subscribe((data_user) => {\n          this.korisnik_naziv = data_user['display_name'];\n          this.korisnik_slika = data_user['slika'];\n          this.smjestaj_toggle = data_user['subscribe_smjestaj'];\n          this.gastro_toggle = data_user['subscribe_gastro'];\n          this.dogadjanja_toggle = data_user['subscribe_dogadjanja'];\n          this.duhovni_kutak_toggle = data_user['subscribe_duhovni_kutak'];\n        });\n\n\n      }\n    });\n\n  }\n\n  async slika_user()\n  {\n    try{\n\n      const options: CameraOptions = {\n        quality: 50,\n        targetWidth: 500,\n        targetHeight: 500,\n        destinationType: this.camera.DestinationType.DATA_URL,\n        encodingType: this.camera.EncodingType.JPEG,\n        mediaType: this.camera.MediaType.PICTURE,\n        saveToPhotoAlbum: false,\n        allowEdit : true,\n        correctOrientation: true,\n        sourceType: 0\n      }\n\n      await this.camera.getPicture(options).then((imageData) => {\n       // imageData is either a base64 encoded string or a file URI\n       // If it's base64:\n       let base64Image = 'data:image/jpeg;base64,' + imageData;\n       this.slika = base64Image;\n       this.slika_validation = 'true';\n       this.korisnik_slika = this.slika;\n\n\n\n       this.auth.authState.subscribe(data => {\n         if (data && data.uid) {\n\n           var storageRef = firebase.storage().ref('user_img/' + data.uid);\n\n           storageRef.putString(this.slika, firebase.storage.StringFormat.DATA_URL).then(function(snapshot) {\n\n             firebase.database().ref('user_profiles/' + data.uid).update({\n                 slika: snapshot.downloadURL,\n               });\n\n           });\n\n         }\n       });\n\n\n\n      }, (err) => {\n       // Handle error\n      });\n      }\n      catch(e)\n      {\n\n      }\n\n      this.update_user_profile();\n  }\n\n  subscribe(tip)\n  {\n\n    this.auth.authState.subscribe(data => {\n      if (data && data.uid) {\n\n        if(tip == 'smjestaj')\n        {\n          if(this.smjestaj_toggle)\n          {\n            this.firebase_plugin.subscribe('topic_smjestaj');\n          }\n          else\n          {\n            this.firebase_plugin.unsubscribe('topic_smjestaj');\n          }\n\n          firebase.database().ref('user_profiles/' + data.uid).update({\n              subscribe_smjestaj: this.smjestaj_toggle,\n            });\n\n        }\n        if(tip == 'gastro')\n        {\n          if(this.gastro_toggle)\n          {\n            this.firebase_plugin.subscribe('topic_gastro');\n          }\n          else\n          {\n            this.firebase_plugin.unsubscribe('topic_gastro');\n          }\n\n          firebase.database().ref('user_profiles/' + data.uid).update({\n              subscribe_gastro: this.gastro_toggle,\n            });\n\n        }\n        if(tip == 'duhovni_kutak')\n        {\n          if(this.duhovni_kutak_toggle)\n          {\n            this.firebase_plugin.subscribe('topic_duhovni_kutak');\n          }\n          else\n          {\n            this.firebase_plugin.unsubscribe('topic_duhovni_kutak');\n          }\n\n          firebase.database().ref('user_profiles/' + data.uid).update({\n              subscribe_duhovni_kutak: this.duhovni_kutak_toggle,\n            });\n\n        }\n        if(tip == 'dogadjanja')\n        {\n          if(this.dogadjanja_toggle)\n          {\n            this.firebase_plugin.subscribe('topic_dogadjanja');\n          }\n          else\n          {\n            this.firebase_plugin.unsubscribe('topic_dogadjanja');\n          }\n\n          firebase.database().ref('user_profiles/' + data.uid).update({\n              subscribe_dogadjanja: this.dogadjanja_toggle,\n            });\n\n        }\n\n      }\n    });\n  }\n\n  username_change(username : string ) {\n\n    if(username.length > 3)\n    {\n      this.auth.authState.subscribe(data => {\n        if (data && data.uid) {\n          firebase.database().ref('user_profiles/' + data.uid).update({\n              display_name: username,\n            });\n          }\n        });\n    }\n\n    this.update_user_profile();\n\n  }\n\n  update_user_profile()\n  {\n    var user = firebase.auth().currentUser;\n\n    this.db.object(\"/user_profiles/\" + user.uid).valueChanges().subscribe((data_user) => {\n\n      if(data_user)\n      {\n        user.updateProfile({\n          displayName: data_user['display_name'],\n          photoURL: data_user['slika']\n        }).then(function() {\n          // Update successful.\n        }).catch(function(error) {\n          // An error happened.\n        });\n      }\n\n    });\n\n\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/user-postavke/user-postavke.ts"],"sourceRoot":""}